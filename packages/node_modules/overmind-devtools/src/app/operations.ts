import { When, Filter, Map, Run } from './'
import { Message } from './types'

export const isPortExistsMessage: When<Message> = ({ value: message }) =>
  message.messages[0].type === 'PORT_EXISTS'

export const confirm: (text: string) => Filter = (text) => ({ utils }) =>
  utils.confirmDialog(text)

export const getCurrentPortFromStorage: Map<any, Promise<string>> = ({
  storage,
}) => storage.get<string>('currentPort')

export const getNewPortFromState: Map<any, string> = ({ state }) =>
  state.newPortValue

export const toNumber: Map<string, string> = ({ value }) =>
  String(Number(value))

export const connectCurrentPort: (action: (message: any) => void) => Run = (
  action
) => ({ state, connector }) => {
  connector.connect(
    state.port,
    action
  )
}

export const isNotExpandingAllActions: Filter = ({ state }) =>
  !state.expandAllActionDetails
